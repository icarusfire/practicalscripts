private static final IdGenerator IDS = IdGenerator.random();

private RequestSpecification addTraceHeader(RequestSpecification request) {
    String traceId = IDS.generateTraceId();
    String spanId  = IDS.generateSpanId();

    SpanContext ctx = SpanContext.create(
            traceId,
            spanId,
            TraceFlags.getSampled(),        // mark as sampled to keep behaviour similar
            TraceState.getDefault());

    Context otelCtx = Context.root().with(Span.wrap(ctx));

    TextMapSetter<RequestSpecification> setter = RequestSpecification::header;
    GlobalOpenTelemetry.getPropagators()
                       .getTextMapPropagator()
                       .inject(otelCtx, request, setter);

    return request;
}
